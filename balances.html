<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>PayApp - Balances</title>

  <!-- Bootstrap core CSS -->
  <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">


</head>

<body>

  <!-- Navigation -->
  <div id="nav-placeholder"></div>


  <!-- Page Content# -->
  <div class="container">
  <br>
  <h3></h3>
  <br>
  <div class="form-row">
      <button type="button" class="btn btn-primary" id="addtransaction">Add Transaction</button>
            &nbsp; 
            &nbsp; 
      <button type="button" class="btn btn-primary" id="viewtransactions">View All Transactions</button>
  </div>
  <br>

  <table class="table table-hover">
    <thead class="thead-light">
      <tr>
        <th>Name</th>
        <th>Spent</th>
        <th>Owes</th>
        <th>Credit</th>
      </tr>
    </thead>
    <tbody id="tablebody">
  </table>

  </div>

  <!-- Bootstrap core JavaScript -->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

</body>

<script>
  $("#nav-placeholder").load("nav.html");
  $("h3").text(localStorage.getItem("groupname"))

  console.log(localStorage.getItem("groupid"))

  var data = {'Toni': {'spent': 10, 'owes': 20, 'credit':-10}, 'MÃ¤': {'spent': 20, 'owes': 40, 'credit':20}};
  updateTable(data);

	function tableInnerHTML(name, spent, owes, credit) {
    var htmlText = `<tr style="cursor:pointer;" name="` + name + `"><td>` + name;
    var cellTagGreen = `</td><td class="text-success">`;
    var cellTagRed = `</td><td class="text-danger">`;
    var rowEnd = `</td></tr>`;

    balances = [spent, owes, credit];
    for (var b of balances){
      if (b >=0)
        htmlText += cellTagGreen + b;
      else
        htmlText += cellTagRed + b;
    }
    htmlText += rowEnd;

		return htmlText;
	}

	function updateTable(data){
		for (var participant in data) {
      balance = data[participant];
			$("#tablebody").append(tableInnerHTML(participant, balance['spent'], balance['owes'], balance['credit'])); 
		}
	}

	$("body").on("click", "[name='deletebutton']", function(e) {
		var groupname = $(this).parent().parent().attr("data-groupname");
		var groupid = $(this).parent().parent().attr("data-groupid");
		$("#confirmmessage").attr("data-groupid", groupid);
		$("#confirmmessage").html("are you sure you want to leave the group '" + groupname + "'?");
		$("#deletedialog").modal("show");
	});

	$("body").on("click", "tr", function(e) {
		var name = $(this).attr("name");
  });
  
  $("#addtransaction").on("click", function(e) {
    location.href = "addtransaction.html"
  })


</script>

</html>
